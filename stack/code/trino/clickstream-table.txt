# Trino->hive.clickstream

CREATE SCHEMA hive.clickstream WITH (location = 's3a://demo-bucket/clicks/');

CREATE TABLE hive.clickstream.user_clicks (
    referrer VARCHAR,
    user_id INTEGER,
    product_id INTEGER,
    session_id VARCHAR,
    action VARCHAR,
    user_agent VARCHAR,
    timestamp VARCHAR,
    partition INTEGER
)
WITH (
    format = 'JSON',
    partitioned_by = ARRAY['partition'],
    external_location = 's3a://clickstream-bucket/topics/user_clickstream/'
);

CALL system.sync_partition_metadata('clickstream', 'user_clicks', 'ADD');



SELECT * FROM hive.clickstream."user_clicks$partitions";


SELECT * FROM hive.clickstream.user_clicks WHERE partition = 0;

SELECT * FROM hive.clickstream.user_clicks;